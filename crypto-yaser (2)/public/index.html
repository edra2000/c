
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Crypto Yaser</title>
  <style>
    body { font-family: Arial; background: #111; color: #fff; margin: 0; padding: 0; }
    header { background: #1e1e1e; padding: 10px 20px; display: flex; align-items: center; justify-content: space-between; }
    header img { width: 40px; height: 40px; }
    header h1 { font-size: 1.5em; margin: 0 0 0 10px; color: #00ffe7; display: inline-block; }
    .crypto-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; padding: 20px; }
    .crypto-card { background: #222; border-radius: 8px; padding: 10px; text-align: center; transition: transform 0.2s; }
    .crypto-card:hover { transform: scale(1.05); }
    .symbol { font-weight: bold; margin-top: 5px; }
    .price, .change, .volume { margin: 5px 0; }
    .positive { color: #0f0; }
    .negative { color: #f33; }
    .loading { text-align: center; padding: 20px; }
    .liquidity-bar { height: 6px; background: linear-gradient(to right, #0f0, #ff0, #f00); margin-top: 10px; }
  </style>
</head>
<body>
  <header>
    <div style="display: flex; align-items: center;">
      <img src="https://via.placeholder.com/40" alt="Logo">
      <h1>Crypto Yaser</h1>
    </div>
  </header>
  <div class="loading">جاري تحميل البيانات...</div>
  <div class="crypto-grid" style="display: none;"></div>

  <script>
    const grid = document.querySelector('.crypto-grid');
    const loading = document.querySelector('.loading');

    async function fetchData() {
      try {
        const res = await fetch('/api/binance');
        const data = await res.json();

        grid.innerHTML = '';
        data
          .filter(coin => coin.symbol.endsWith('USDT') && parseFloat(coin.lastPrice) > 0)
          .slice(0, 50)
          .forEach(coin => {
            const change = parseFloat(coin.priceChangePercent);
            const price = parseFloat(coin.lastPrice);
            const volume = parseFloat(coin.quoteVolume);
            const symbol = coin.symbol.replace('USDT', '');
            const logoUrl = `https://cryptoicon-api.pages.dev/api/icon/${symbol.toLowerCase()}`;

            const card = document.createElement('div');
            card.className = 'crypto-card';
            card.innerHTML = `
              <img src="${logoUrl}" onerror="this.src='https://via.placeholder.com/32'" width="32" height="32" />
              <div class="symbol">${symbol}</div>
              <div class="price">${price.toFixed(4)} USDT</div>
              <div class="change ${change >= 0 ? 'positive' : 'negative'}">${change.toFixed(2)}%</div>
              <div class="volume">الحجم: ${volume.toFixed(2)}</div>
              <div class="liquidity-bar"></div>
            `;
            grid.appendChild(card);
          });

        loading.style.display = 'none';
        grid.style.display = 'grid';
      } catch (err) {
        loading.textContent = 'فشل تحميل البيانات.';
        console.error(err);
      }
    }

    fetchData();
    setInterval(fetchData, 10000);
  </script>
</body>
</html>
